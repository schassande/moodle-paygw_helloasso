<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="blocks/myplugin/db" VERSION="20250101" COMMENT="XMLDB file for Moodle blocks/myplugin">
  <TABLES>
    <TABLE NAME="payment_helloasso_logs" COMMENT="HelloAsso payment gateway logs">
      <FIELDS>
        <FIELD NAME="id"            TYPE="int"      LENGTH="10"     NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="paymentid"     TYPE="int"      LENGTH="10"     NOTNULL="true" COMMENT="Payment transaction ID"/>
        <FIELD NAME="userid"        TYPE="int"      LENGTH="10"     NOTNULL="true" COMMENT="User ID"/>
        <FIELD NAME="action"        TYPE="char"     LENGTH="50"     NOTNULL="true" COMMENT="Action type (api_call, token_request, webhook, etc)"/>
        <FIELD NAME="status"        TYPE="char"     LENGTH="20"     NOTNULL="true" COMMENT="success, error, fraud_detected"/>
        <FIELD NAME="amount"        TYPE="decimal"  LENGTH="10,2"   NOTNULL="true" COMMENT="Payment amount"/>
        <FIELD NAME="reference"     TYPE="char"     LENGTH="255"    NOTNULL="false" COMMENT="HelloAsso reference"/>
        <FIELD NAME="message"       TYPE="text"                     NOTNULL="false" COMMENT="Log message or error details"/>
        <FIELD NAME="response_code" TYPE="int"      LENGTH="3"      NOTNULL="false" COMMENT="HTTP response code"/>
        <FIELD NAME="ip_address"    TYPE="char"     LENGTH="45"     NOTNULL="false" COMMENT="Client IP address"/>
        <FIELD NAME="timecreated"   TYPE="int"      LENGTH="10"     NOTNULL="true" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary"         TYPE="primary" FIELDS="id"/>
        <KEY NAME="paymentid"       TYPE="foreign" FIELDS="paymentid" REFTABLE="payments" REFFIELDS="id"/>
        <KEY NAME="userid"          TYPE="foreign" FIELDS="userid" REFTABLE="user" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="timecreated"   UNIQUE="false" FIELDS="timecreated"/>
        <INDEX NAME="status"        UNIQUE="false" FIELDS="status"/>
      </INDEXES>
    </TABLE>
  </TABLES>
</XMLDB>